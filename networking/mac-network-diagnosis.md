# Getting info about issues:

```
https://twitter.com/SparkNZ
http://www.spark.co.nz/help/servicealert/
```

# Reliable IP Addresses for network testing

```
Some IPs that came up for google.co.nz in sept 2014:
74.125.237.191
74.125.237.143
74.125.237.159
74.125.237.152
74.125.237.151
```

Can also use the NZ name servers

# .nz nameservers

```
Nameserver	Provider	Location			Type		IP
ns1.dns.net.nz	NZRS		New Zealand			Unicast		202.46.190.130 2001:dce:2000:2::130
ns2.dns.net.nz	NZRS		New Zealand			Anycast		202.46.191.130 2001:dce:4000:2::130
ns3.dns.net.nz	NZRS		New Zealand			Anycast		202.46.188.130
ns4.dns.net.nz	NZRS		New Zealand			Anycast		202.46.189.130
ns5.dns.net.nz	NeuStar 	UltraDNS Multiple International	Anycast		204.74.112.253 2001:0502:D399::253
ns6.dns.net.nz	NeuStar 	UltraDNS Multiple International	Anycast		204.74.113.253
ns7.dns.net.nz	Autonomica	Multiple International		Anycast		194.146.106.54
```

# IP addresses that are known to be overseas

- handy to see how the NZ international connection is doing

America:

```
ns1.google.com
216.239.32.10

is apparently in mountain view california according to
http://whois.domaintools.com/216.239.32.10
```

```
eircom.ie DNS servers:
    Primary DNS:    159.134.0.1
    Secondary DNS:  159.134.0.2

Google DNS servers:
    8.8.8.8
    8.8.4.4
```

Aside:

```
    Average RTT to ireland seems to be ~ 330 ms
    Average RTT to NZ name servers ~ 30 ms
    Average RTT to californai ~ 270 ms
```

# DNS servers

- by default router acts as DNS forwarder (setup via DHCP) but you can add your
  own in System Preferences > Network

```
Spark NZ
Primary DNS: 122.56.237.1
SecondaryDNS: 210.55.111.1

Google DNS
https://developers.google.com/speed/public-dns/
8.8.8.8
8.8.4.4
```

- can manually specify DNS servers
- Aside: `/etc/resolv.conf` is auto-generated by mac OS and is **not** the
  primary source of dns info

```
scutil --dns # shows some DNS stuff in system configuration
```

# whois lookups

Network utility on mac is pretty handy for this

The NZ Registry services whois is at:

```
whois.srs.net.nz.
```

QUESTION: how does 'lookup' on mac network utility work? It doesn't seem to!

Ports used by apple devices: http://support.apple.com/kb/HT6175?viewlocale=en_US

# What are DNS search domains?

- Domains you add to here are searched if you type a bareword into a browser
  address bar or [other places ???]. _ TODO: I couldn't get safari to us them as
  it just did a google search. _ Maybe figure out where these would actually be
  used by the system.
- Useful in a corporate setting. Can be ignored in a home setting.

# OSX: How to quickly change DNS server on mac

Do it via the GUI in System Preferences > Network

# OSX: Basic network information

- en0 is my main wifi network interface on the macbook air

```
ifconfig -v
ifconfig -v en0
```

# OSX: How do i see my gateway IP?

```
netstat -nr
route -n get default
```

# OSX: How do i see what DNS servers system is using

- Do it via the GUI in System Preferences > Network
- ??? how to do it on command line?

# How do I flush DNS cache?

```
sudo killall -HUP mDNSResponder

sudo discoveryutil mdnsflushcache # Yosemite v10.10 - v10.10.3 only
```

# Steps to diagnose a network issue

Steup a bunch of pings to look for latency and dropped packets

first test without relying on DNS lookup

1. Figure out what gateway the machine uses
1. Setup a ping to the gateway IP
1. TODO: figure out how to see what DNS servers gateway is using. Via DHCP?
1. ping the primary and secondary DNS IPs

TODO: finish this

Q: How do you check that a machine is alive if it does not respond to ping?
